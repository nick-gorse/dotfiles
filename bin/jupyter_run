#!/usr/bin/zsh
#

function jupyter_start() {
	nohup jupyter lab --no-browser --port ${JUP_PORT:-9888} -y > $HOME/jup.log 2>&1 &!
	export JUP_PID=$! 
}

function jupyter_kill() {
	jupyter server stop ${JUP_PORT:-9888} >> $HOME/jup.log 2>&1
	unset JUP_PID
}

function jupyter_run() {
    if ! jupyter server list --json | grep ${JUP_PORT:-9888} > /dev/null 2>&1; then
        jupyter_start
	else
	    while [[ "$1" =~ ^- && ! "$1" == "--" ]]
		do
			case $1 in
				(-r | --restart ) jupyter_kill
						jupyter_start                   ;;
				(-h | --help )	printf "Usage: jupyter_run [-h, --help] [-r, --restart]\n"; return 0 2>/dev/null      ;;
		    	(*) return 1 2>/dev/null                   ;;
			esac
			shift
		done
	    if [[ "$1" == '--' ]]; then shift; fi
    fi
}


